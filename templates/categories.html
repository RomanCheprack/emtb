{% extends "layout.html" %}

{% block title %}
<title>קטגוריות אופניים - גראבל, ילדים, חשמליים, שטח, עיר, כביש | Rideal</title>
{% endblock %}

{% block meta %}
{% set categories_url = url_for('main.categories', _external=True) %}
{% set total_bikes = categories | sum(attribute='count') if categories else 0 %}
{% set meta_description = 'בחר קטגוריית אופניים: חשמליים, שטח, עיר, כביש, גראבל וילדים. מעל ' ~ total_bikes ~ ' דגמי אופניים להשוואה.' %}

<meta name="description" content="{{ meta_description }}">
<link rel="canonical" href="{{ categories_url }}">

<!-- Open Graph / Facebook / WhatsApp / Telegram -->
<meta property="og:type" content="website">
<meta property="og:url" content="{{ categories_url }}">
<meta property="og:title" content="קטגוריות אופניים - חשמליים, שטח, עיר, כביש | Rideal">
<meta property="og:description" content="{{ meta_description }}">
<meta property="og:image" content="{{ url_for('static', filename='images/rideal_logo_bg.png', _external=True) }}">
<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:url" content="{{ categories_url }}">
<meta name="twitter:title" content="קטגוריות אופניים - חשמליים, שטח, עיר, כביש | Rideal">
<meta name="twitter:description" content="{{ meta_description }}">
<meta name="twitter:image" content="{{ url_for('static', filename='images/rideal_logo_bg.png', _external=True) }}">

<!-- CollectionPage Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "קטגוריות אופניים",
  "description": "{{ meta_description | replace('"', '\\"') }}",
  "url": "{{ categories_url }}",
  "mainEntity": {
    "@type": "ItemList",
    "numberOfItems": {{ categories | length }},
    "itemListElement": [
      {% for category in categories %}
      {
        "@type": "ListItem",
        "position": {{ loop.index }},
        "name": "{{ category.name }}",
        "description": "{{ category.description }}",
        "url": "{% if category.slug == 'mtb' %}{{ url_for('main.mtb_subcategories', _external=True) }}{% elif category.slug == 'electric' %}{{ url_for('main.electric_subcategories', _external=True) }}{% else %}{{ url_for('bikes.category_bikes', category=category.slug, _external=True) }}{% endif %}"
      }{% if not loop.last %},{% endif %}
      {% endfor %}
    ]
  }
}
</script>
{% endblock %}

{% block content %}

<!-- Hero Section -->
<h1 class="categories-title" dir="rtl">מה רוכבים?</h1>

<!-- Categories Grid -->
<div class="categories-container">
    <div class="categories-grid">
        {% for category in categories %}
        <a href="{% if category.slug == 'mtb' %}{{ url_for('main.mtb_subcategories') }}{% elif category.slug == 'electric' %}{{ url_for('main.electric_subcategories') }}{% else %}{{ url_for('bikes.category_bikes', category=category.slug) }}{% endif %}" 
           class="category-card"
           aria-label="{{ category.name }} - {{ category.description }}">
            <div class="category-card-image-wrapper">
                <img src="{{ url_for('static', filename=category.image) }}?v={{ config.VERSION if config.VERSION else '1.0' }}" 
                     alt="{{ category.name }}"
                     class="category-card-image"
                     loading="lazy">
            </div>
            <div class="category-card-content">
                <div class="category-card-header">
                    <h2 class="category-card-title">{{ category.name }}</h2>
                    <p class="category-card-description">{{ category.description }}</p>
                </div>
                <span class="category-card-count">{{ category.count }} דגמים</span>
            </div>
        </a>
        {% endfor %}
    </div>
</div>

<script>
    // Image loading with fade-in effect
    document.addEventListener('DOMContentLoaded', function() {
        const images = document.querySelectorAll('.category-card-image');
        
        images.forEach(img => {
            if (img.complete) {
                img.classList.add('loaded');
            } else {
                img.addEventListener('load', function() {
                    img.classList.add('loaded');
                });
            }
        });
        
        // Add ripple effect on touch (mobile)
        if ('ontouchstart' in window) {
            const cards = document.querySelectorAll('.category-card');
            
            cards.forEach(card => {
                card.addEventListener('touchstart', function(e) {
                    this.style.transition = 'transform 0.1s ease';
                }, { passive: true });
                
                card.addEventListener('touchend', function(e) {
                    this.style.transition = 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
                }, { passive: true });
            });
        }
    });
</script>

{% endblock %}

